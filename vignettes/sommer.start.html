<!DOCTYPE html>

<html xmlns="http://www.w3.org/1999/xhtml">

<head>

<meta charset="utf-8" />
<meta http-equiv="Content-Type" content="text/html; charset=utf-8" />
<meta name="generator" content="pandoc" />

<meta name="viewport" content="width=device-width, initial-scale=1">

<meta name="author" content="Giovanny Covarrubias-Pazaran" />

<meta name="date" content="2018-12-02" />

<title>Quick start for the sommer package</title>



<style type="text/css">code{white-space: pre;}</style>
<style type="text/css">
div.sourceCode { overflow-x: auto; }
table.sourceCode, tr.sourceCode, td.lineNumbers, td.sourceCode {
  margin: 0; padding: 0; vertical-align: baseline; border: none; }
table.sourceCode { width: 100%; line-height: 100%; }
td.lineNumbers { text-align: right; padding-right: 4px; padding-left: 4px; color: #aaaaaa; border-right: 1px solid #aaaaaa; }
td.sourceCode { padding-left: 5px; }
code > span.kw { color: #007020; font-weight: bold; } /* Keyword */
code > span.dt { color: #902000; } /* DataType */
code > span.dv { color: #40a070; } /* DecVal */
code > span.bn { color: #40a070; } /* BaseN */
code > span.fl { color: #40a070; } /* Float */
code > span.ch { color: #4070a0; } /* Char */
code > span.st { color: #4070a0; } /* String */
code > span.co { color: #60a0b0; font-style: italic; } /* Comment */
code > span.ot { color: #007020; } /* Other */
code > span.al { color: #ff0000; font-weight: bold; } /* Alert */
code > span.fu { color: #06287e; } /* Function */
code > span.er { color: #ff0000; font-weight: bold; } /* Error */
code > span.wa { color: #60a0b0; font-weight: bold; font-style: italic; } /* Warning */
code > span.cn { color: #880000; } /* Constant */
code > span.sc { color: #4070a0; } /* SpecialChar */
code > span.vs { color: #4070a0; } /* VerbatimString */
code > span.ss { color: #bb6688; } /* SpecialString */
code > span.im { } /* Import */
code > span.va { color: #19177c; } /* Variable */
code > span.cf { color: #007020; font-weight: bold; } /* ControlFlow */
code > span.op { color: #666666; } /* Operator */
code > span.bu { } /* BuiltIn */
code > span.ex { } /* Extension */
code > span.pp { color: #bc7a00; } /* Preprocessor */
code > span.at { color: #7d9029; } /* Attribute */
code > span.do { color: #ba2121; font-style: italic; } /* Documentation */
code > span.an { color: #60a0b0; font-weight: bold; font-style: italic; } /* Annotation */
code > span.cv { color: #60a0b0; font-weight: bold; font-style: italic; } /* CommentVar */
code > span.in { color: #60a0b0; font-weight: bold; font-style: italic; } /* Information */
</style>



<link href="data:text/css;charset=utf-8,body%20%7B%0Abackground%2Dcolor%3A%20%23fff%3B%0Amargin%3A%201em%20auto%3B%0Amax%2Dwidth%3A%20700px%3B%0Aoverflow%3A%20visible%3B%0Apadding%2Dleft%3A%202em%3B%0Apadding%2Dright%3A%202em%3B%0Afont%2Dfamily%3A%20%22Open%20Sans%22%2C%20%22Helvetica%20Neue%22%2C%20Helvetica%2C%20Arial%2C%20sans%2Dserif%3B%0Afont%2Dsize%3A%2014px%3B%0Aline%2Dheight%3A%201%2E35%3B%0A%7D%0A%23header%20%7B%0Atext%2Dalign%3A%20center%3B%0A%7D%0A%23TOC%20%7B%0Aclear%3A%20both%3B%0Amargin%3A%200%200%2010px%2010px%3B%0Apadding%3A%204px%3B%0Awidth%3A%20400px%3B%0Aborder%3A%201px%20solid%20%23CCCCCC%3B%0Aborder%2Dradius%3A%205px%3B%0Abackground%2Dcolor%3A%20%23f6f6f6%3B%0Afont%2Dsize%3A%2013px%3B%0Aline%2Dheight%3A%201%2E3%3B%0A%7D%0A%23TOC%20%2Etoctitle%20%7B%0Afont%2Dweight%3A%20bold%3B%0Afont%2Dsize%3A%2015px%3B%0Amargin%2Dleft%3A%205px%3B%0A%7D%0A%23TOC%20ul%20%7B%0Apadding%2Dleft%3A%2040px%3B%0Amargin%2Dleft%3A%20%2D1%2E5em%3B%0Amargin%2Dtop%3A%205px%3B%0Amargin%2Dbottom%3A%205px%3B%0A%7D%0A%23TOC%20ul%20ul%20%7B%0Amargin%2Dleft%3A%20%2D2em%3B%0A%7D%0A%23TOC%20li%20%7B%0Aline%2Dheight%3A%2016px%3B%0A%7D%0Atable%20%7B%0Amargin%3A%201em%20auto%3B%0Aborder%2Dwidth%3A%201px%3B%0Aborder%2Dcolor%3A%20%23DDDDDD%3B%0Aborder%2Dstyle%3A%20outset%3B%0Aborder%2Dcollapse%3A%20collapse%3B%0A%7D%0Atable%20th%20%7B%0Aborder%2Dwidth%3A%202px%3B%0Apadding%3A%205px%3B%0Aborder%2Dstyle%3A%20inset%3B%0A%7D%0Atable%20td%20%7B%0Aborder%2Dwidth%3A%201px%3B%0Aborder%2Dstyle%3A%20inset%3B%0Aline%2Dheight%3A%2018px%3B%0Apadding%3A%205px%205px%3B%0A%7D%0Atable%2C%20table%20th%2C%20table%20td%20%7B%0Aborder%2Dleft%2Dstyle%3A%20none%3B%0Aborder%2Dright%2Dstyle%3A%20none%3B%0A%7D%0Atable%20thead%2C%20table%20tr%2Eeven%20%7B%0Abackground%2Dcolor%3A%20%23f7f7f7%3B%0A%7D%0Ap%20%7B%0Amargin%3A%200%2E5em%200%3B%0A%7D%0Ablockquote%20%7B%0Abackground%2Dcolor%3A%20%23f6f6f6%3B%0Apadding%3A%200%2E25em%200%2E75em%3B%0A%7D%0Ahr%20%7B%0Aborder%2Dstyle%3A%20solid%3B%0Aborder%3A%20none%3B%0Aborder%2Dtop%3A%201px%20solid%20%23777%3B%0Amargin%3A%2028px%200%3B%0A%7D%0Adl%20%7B%0Amargin%2Dleft%3A%200%3B%0A%7D%0Adl%20dd%20%7B%0Amargin%2Dbottom%3A%2013px%3B%0Amargin%2Dleft%3A%2013px%3B%0A%7D%0Adl%20dt%20%7B%0Afont%2Dweight%3A%20bold%3B%0A%7D%0Aul%20%7B%0Amargin%2Dtop%3A%200%3B%0A%7D%0Aul%20li%20%7B%0Alist%2Dstyle%3A%20circle%20outside%3B%0A%7D%0Aul%20ul%20%7B%0Amargin%2Dbottom%3A%200%3B%0A%7D%0Apre%2C%20code%20%7B%0Abackground%2Dcolor%3A%20%23f7f7f7%3B%0Aborder%2Dradius%3A%203px%3B%0Acolor%3A%20%23333%3B%0Awhite%2Dspace%3A%20pre%2Dwrap%3B%20%0A%7D%0Apre%20%7B%0Aborder%2Dradius%3A%203px%3B%0Amargin%3A%205px%200px%2010px%200px%3B%0Apadding%3A%2010px%3B%0A%7D%0Apre%3Anot%28%5Bclass%5D%29%20%7B%0Abackground%2Dcolor%3A%20%23f7f7f7%3B%0A%7D%0Acode%20%7B%0Afont%2Dfamily%3A%20Consolas%2C%20Monaco%2C%20%27Courier%20New%27%2C%20monospace%3B%0Afont%2Dsize%3A%2085%25%3B%0A%7D%0Ap%20%3E%20code%2C%20li%20%3E%20code%20%7B%0Apadding%3A%202px%200px%3B%0A%7D%0Adiv%2Efigure%20%7B%0Atext%2Dalign%3A%20center%3B%0A%7D%0Aimg%20%7B%0Abackground%2Dcolor%3A%20%23FFFFFF%3B%0Apadding%3A%202px%3B%0Aborder%3A%201px%20solid%20%23DDDDDD%3B%0Aborder%2Dradius%3A%203px%3B%0Aborder%3A%201px%20solid%20%23CCCCCC%3B%0Amargin%3A%200%205px%3B%0A%7D%0Ah1%20%7B%0Amargin%2Dtop%3A%200%3B%0Afont%2Dsize%3A%2035px%3B%0Aline%2Dheight%3A%2040px%3B%0A%7D%0Ah2%20%7B%0Aborder%2Dbottom%3A%204px%20solid%20%23f7f7f7%3B%0Apadding%2Dtop%3A%2010px%3B%0Apadding%2Dbottom%3A%202px%3B%0Afont%2Dsize%3A%20145%25%3B%0A%7D%0Ah3%20%7B%0Aborder%2Dbottom%3A%202px%20solid%20%23f7f7f7%3B%0Apadding%2Dtop%3A%2010px%3B%0Afont%2Dsize%3A%20120%25%3B%0A%7D%0Ah4%20%7B%0Aborder%2Dbottom%3A%201px%20solid%20%23f7f7f7%3B%0Amargin%2Dleft%3A%208px%3B%0Afont%2Dsize%3A%20105%25%3B%0A%7D%0Ah5%2C%20h6%20%7B%0Aborder%2Dbottom%3A%201px%20solid%20%23ccc%3B%0Afont%2Dsize%3A%20105%25%3B%0A%7D%0Aa%20%7B%0Acolor%3A%20%230033dd%3B%0Atext%2Ddecoration%3A%20none%3B%0A%7D%0Aa%3Ahover%20%7B%0Acolor%3A%20%236666ff%3B%20%7D%0Aa%3Avisited%20%7B%0Acolor%3A%20%23800080%3B%20%7D%0Aa%3Avisited%3Ahover%20%7B%0Acolor%3A%20%23BB00BB%3B%20%7D%0Aa%5Bhref%5E%3D%22http%3A%22%5D%20%7B%0Atext%2Ddecoration%3A%20underline%3B%20%7D%0Aa%5Bhref%5E%3D%22https%3A%22%5D%20%7B%0Atext%2Ddecoration%3A%20underline%3B%20%7D%0A%0Acode%20%3E%20span%2Ekw%20%7B%20color%3A%20%23555%3B%20font%2Dweight%3A%20bold%3B%20%7D%20%0Acode%20%3E%20span%2Edt%20%7B%20color%3A%20%23902000%3B%20%7D%20%0Acode%20%3E%20span%2Edv%20%7B%20color%3A%20%2340a070%3B%20%7D%20%0Acode%20%3E%20span%2Ebn%20%7B%20color%3A%20%23d14%3B%20%7D%20%0Acode%20%3E%20span%2Efl%20%7B%20color%3A%20%23d14%3B%20%7D%20%0Acode%20%3E%20span%2Ech%20%7B%20color%3A%20%23d14%3B%20%7D%20%0Acode%20%3E%20span%2Est%20%7B%20color%3A%20%23d14%3B%20%7D%20%0Acode%20%3E%20span%2Eco%20%7B%20color%3A%20%23888888%3B%20font%2Dstyle%3A%20italic%3B%20%7D%20%0Acode%20%3E%20span%2Eot%20%7B%20color%3A%20%23007020%3B%20%7D%20%0Acode%20%3E%20span%2Eal%20%7B%20color%3A%20%23ff0000%3B%20font%2Dweight%3A%20bold%3B%20%7D%20%0Acode%20%3E%20span%2Efu%20%7B%20color%3A%20%23900%3B%20font%2Dweight%3A%20bold%3B%20%7D%20%20code%20%3E%20span%2Eer%20%7B%20color%3A%20%23a61717%3B%20background%2Dcolor%3A%20%23e3d2d2%3B%20%7D%20%0A" rel="stylesheet" type="text/css" />

</head>

<body>




<h1 class="title toc-ignore">Quick start for the sommer package</h1>
<h4 class="author"><em>Giovanny Covarrubias-Pazaran</em></h4>
<h4 class="date"><em>2018-12-02</em></h4>



<p>The sommer package was developed to provide R users a powerful and reliable multivariate mixed model solver. The package is focused in problems of the type p &gt; n (more effects to estimate than observations) and its core algorithm is coded in C++ using the Armadillo library. This package allows the user to fit mixed models with the advantage of specifying the variance-covariance structure for the random effects, and specify heterogeneous variances, and obtain other parameters such as BLUPs, BLUEs, residuals, fitted values, variances for fixed and random effects, etc.</p>
<p>The purpose of this quick start guide is to show the flexibility of the package under certain common scenarios:</p>
<p>B1) Background on mixed models</p>
<p>B2) Background on covariance structures</p>
<ol style="list-style-type: decimal">
<li>Univariate homogeneous variance models</li>
<li>Univariate heterogeneous variance models</li>
<li>Univariate unstructured variance models</li>
<li>Multivariate homogeneous variance models</li>
<li>Multivariate heterogeneous variance models</li>
<li>Multivariate unstructured variance models</li>
<li>Random regression models</li>
<li>GWAS models</li>
<li>Including special functions</li>
</ol>
<ul>
<li>the major vs() function for special variance models and its auxiliars:
<ul>
<li>at() specific levels structure</li>
<li>ds() diagonal structure</li>
<li>us() unstructured</li>
<li>cs() customized structure</li>
<li>overlay() overlayed models</li>
<li>spl2D() two dimensional spline models</li>
</ul></li>
</ul>
<ol start="10" style="list-style-type: decimal">
<li>The specification of constraints</li>
<li>Final remarks</li>
</ol>
<div id="b1-background-on-mixed-models" class="section level2">
<h2>B1) Background on mixed models</h2>
<p>The core of the package are the <code>mmer2</code> (formula-based) and <code>mmer</code> (matrix-based) functions which solve the mixed model equations. The functions are an interface to call the <code>NR</code> Direct-Inversion Newton-Raphson (Tunnicliffe 1989; Gilmour et al. 1995; Lee et al. 2016) or the <code>EMMA</code> efficient mixed model association algorithm (Kang et al. 2008). From version 2.0, sommer can handle multivariate models. Following Maier et al. (2015), the multivariate (and by extension the univariate) mixed model implemented has the form:</p>
<p><br></p>
<p><span class="math inline">\(y_1 = X_1\beta_1 + Z_1u_1 + \epsilon_1\)</span></p>
<p><span class="math inline">\(y_2 = X_2\beta_2 + Z_2u_2 + \epsilon_2\)</span></p>
<p>…</p>
<p><span class="math inline">\(y_i = X_i\beta_i + Z_iu_i + \epsilon_i\)</span></p>
<p><br></p>
<p>where <span class="math inline">\(y_i\)</span> is a vector of trait phenotypes, <span class="math inline">\(\beta_i\)</span> is a vector of fixed effects, <span class="math inline">\(u_i\)</span> is a vector of random effects for individuals and <span class="math inline">\(e_i\)</span> are residuals for trait ‘i’ (i = 1, …, t). The random effects (<span class="math inline">\(u_1\)</span> … <span class="math inline">\(u_i\)</span> and <span class="math inline">\(e_i\)</span>) are assumed to be normally distributed with mean zero. X and Z are incidence matrices for fixed and random effects respectively. The distribution of the multivariate response and the phenotypic variance covariance (V) are:</p>
<p><br></p>
<p><span class="math inline">\(Y = X\beta + ZU + \epsilon_i\)</span></p>
<p><br></p>
<p>Y ~ MVN(<span class="math inline">\(X\beta\)</span>, V)</p>
<p><br></p>
<p><span class="math display">\[\mathbf{Y} = \left[\begin{array}
{r}
y_1 \\
y_2 \\
... \\
y_t \\
\end{array}\right]
\]</span></p>
<p><br></p>
<p><span class="math display">\[\mathbf{X} = \left[\begin{array}
{rrr}
X_1 &amp; 0 &amp; 0 \\
\vdots &amp; \ddots &amp; \vdots\\
0 &amp; 0 &amp; X_t \\
\end{array}\right]
\]</span></p>
<p><br></p>
<p><span class="math display">\[\mathbf{V} = \left[\begin{array}
{rrr}
Z_1 K{\sigma^2_{g_{1}}} Z_1' + H{\sigma^2_{\epsilon_{1}}} &amp; ... &amp; Z_1 K{\sigma_{g_{1,t}}} Z_t' + H{\sigma_{\epsilon_{1,t}}} \\
\vdots &amp; \ddots &amp; \vdots\\
Z_1 K{\sigma_{g_{1,t}}} Z_t' + H{\sigma_{\epsilon_{1,t}}} &amp; ... &amp; Z_t K{\sigma^2_{g_{t}}} Z_t' + H{\sigma^2_{\epsilon_{t}}} \\
\end{array}\right]
\]</span></p>
<p><br></p>
<p>where K is the relationship or covariance matrix for the kth random effect (u=1,…,k), and H=I is an identity matrix or a partial identity matrix for the residual term. The terms <span class="math inline">\(\sigma^2_{g_{i}}\)</span> and <span class="math inline">\(\sigma^2_{\epsilon_{i}}\)</span> denote the genetic (or any of the kth random terms) and residual variance of trait ‘i’, respectively and <span class="math inline">\(\sigma_{g_{_{ij}}}\)</span> and <span class="math inline">\(\sigma_{\epsilon_{_{ij}}}\)</span> the genetic (or any of the kth random terms) and residual covariance between traits ‘i’ and ‘j’ (i=1,…,t, and j=1,…,t). The algorithm implemented optimizes the log likelihood:</p>
<p><br></p>
<p><span class="math inline">\(logL = 1/2 * ln(|V|) + ln(X'|V|X) + Y'PY\)</span></p>
<p><br></p>
<p>where || is the determinant of a matrix. And the REML estimates are updated using a Newton optimization algorithm of the form:</p>
<p><br></p>
<p><span class="math inline">\(\theta^{k+1} = \theta^{k} + (H^{k})^{-1}*\frac{dL}{d\sigma^2_i}|\theta^k\)</span></p>
<p><br></p>
<p>Where, <span class="math inline">\(\theta\)</span> is the vector of variance components for random effects and covariance components among traits, <span class="math inline">\(H^{-1}\)</span> is the inverse of the Hessian matrix of second derivatives for the kth cycle, <span class="math inline">\(\frac{dL}{d\sigma^2_i}\)</span> is the vector of first derivatives of the likelihood with respect to the variance-covariance components. The Eigen decomposition of the relationship matrix proposed by Lee and Van Der Werf (2016) was included in the Newton-Raphson algorithm to improve time efficiency. Additionally, the popular pin function to estimate standard errors for linear combinations of variance components (i.e. heritabilities and genetic correlations) was added to the package as well.</p>
<p>The function <code>mmer</code> takes the Zs and Ks for each random effect and construct the neccesary structure inside and estimates the variance components by ML/REML using any of the 4 methods available in sommer. The <code>mmer2</code> function is enabled to work in a model-based fashion so user don’t have to build the Z’s and K matrices. Please refer to the canonical papers listed in the Literature section to check how the algorithms work. We have tested widely the methods to make sure they provide the same solution when the likelihood behaves well but for complex problems they might lead to slightly different answers. If you have any concern please contact me at <a href="mailto:cova_ruber@live.com.mx">cova_ruber@live.com.mx</a>.</p>
<p>In the following section we will go in detail over several examples on how to use mixed models in univariate and multivariate case and their use in quantitative genetics.</p>
<p><br></p>
</div>
<div id="b2-background-on-covariance-structures" class="section level2">
<h2>B2) Background on covariance structures</h2>
<p>One of the major strenghts of linear mixed models is the flexibility to specify variance-covariance structures at all levels. In general, variance structures of mixed models can be seen as tensor (kronecker) products of multiple variance-covariance stuctures. For example, a multi-response model (i.e. 2 traits) where “g” individuals (i.e. 100 genotypes) are tested in “e” treatments (i.e. 3 environments), the variance-covariance for the random effect “individuals” can be seen as the following multiplicative model:</p>
<p>T <span class="math inline">\(\otimes\)</span> G <span class="math inline">\(\otimes\)</span> A</p>
<p>where:</p>
<p><span class="math display">\[\mathbf{T} = \left[\begin{array}
{rr}
{\sigma^2_{g_{_{t1,t1}}}} &amp; {\sigma_{g_{_{t1,t2}}}} \\
{\sigma_{g_{_{t2,t1}}}} &amp; {\sigma^2_{g_{_{t2,t2}}}} \\
\end{array}\right]
\]</span></p>
<p>is the covariance structure for individuals among traits.</p>
<p><span class="math display">\[\mathbf{G} = \left[\begin{array}
{rrr}
{\sigma^2_{g_{_{e1,e1}}}} &amp; {\sigma_{g_{_{e1,e2}}}} &amp; {\sigma_{g_{_{e1,e3}}}} \\
{\sigma_{g_{_{e2,e1}}}} &amp; {\sigma^2_{g_{_{e2,e2}}}} &amp; {\sigma_{g_{_{e2,e3}}}} \\
{\sigma_{g_{_{e3,e1}}}} &amp; {\sigma_{g_{_{e3,e2}}}} &amp; {\sigma^2_{g_{_{e3,e3}}}} \\
\end{array}\right]
\]</span></p>
<p>is the covariance structure for individuals among environments.</p>
<p>and <span class="math inline">\(A\)</span> is a square matrix representing the covariance among the levels of the individuals (any known relationship matrix).</p>
<p>The T and G covariance structures shown above are unknown matrices to be estimated whereas A is known. The T and G matrices shown above are called as unstructured (US) covariance matrices, although this type is just one example from several covariance structures that the linear mixed models enable. For example, other popular covariance structures are:</p>
<p>Diagonal (DIAG) covariance structures</p>
<p><span class="math display">\[\mathbf{\Sigma} = \left[\begin{array}
{rrr}
{\sigma^2_{g_{_{e1,e1}}}} &amp; 0 &amp; 0 \\
\vdots &amp; \ddots &amp; \vdots \\
0 &amp; 0 &amp; {\sigma^2_{g_{_{ei,ei}}}} \\
\end{array}\right]
\]</span> Compound simmetry (CS) covariance structures</p>
<p><span class="math display">\[\mathbf{\Sigma} = \left[\begin{array}
{rrrr}
{\sigma^2_{g}} + {\sigma^2_{ge}} &amp; {\sigma^2_{g}} &amp; {\sigma^2_{g}} &amp; {\sigma^2_{g}} \\
{\sigma^2_{g}} &amp; {\sigma^2_{g}} + {\sigma^2_{ge}} &amp; {\sigma^2_{g}} &amp; {\sigma^2_{g}}\\
\vdots &amp; \vdots &amp; \ddots &amp; \vdots\\
{\sigma^2_{g}} &amp; {\sigma^2_{g}} &amp; {\sigma^2_{g}} &amp; {\sigma^2_{g}} + {\sigma^2_{ge}}\\
\end{array}\right]
\]</span></p>
<p>First order autoregressive (AR1) covariance structures</p>
<p><span class="math display">\[\mathbf{\Sigma} = \sigma^2 \left[\begin{array}
{rrrr}
1 &amp; {\rho} &amp; {\rho^2} &amp; {\rho^3} \\
{\rho} &amp; 1 &amp; {\rho} &amp; {\rho^2}\\
{\rho^2} &amp; {\rho} &amp; 1 &amp; {\rho} \\
{\rho^3} &amp; {\rho^2} &amp; {\rho}  &amp; 1  \\
\end{array}\right]
\]</span></p>
<p>or the already mentioned Unstructured (US) covariance structures</p>
<p><span class="math display">\[\mathbf{\Sigma} = \left[\begin{array}
{rrr}
{\sigma^2_{g_{_{e1,e1}}}} &amp; {\sigma_{g_{_{e1,e2}}}} &amp; {\sigma_{g_{_{e1,e3}}}} \\
\vdots &amp; \ddots &amp; \vdots \\
{\sigma_{g_{_{e3,e1}}}} &amp; {\sigma_{g_{_{e3,e2}}}} &amp; {\sigma^2_{g_{_{e3,e3}}}} \\
\end{array}\right]
\]</span></p>
<p>among others. Sommer has the capabilities to fit some of these covariance structures in the mixed model machinery.</p>
</div>
<div id="forming-variance-structures-in-sommer-using-the-vs-function" class="section level1">
<h1>forming variance structures in sommer using the vs() function</h1>
<p>The sommer function <code>vs()</code> allows to construct very structured variance models that are passed to the <code>mmer()</code> function it’s one of the most important functions in the sommer package. Its specification is:</p>
<p>random=~vs(…, Gu, Gt, Gtc)</p>
<p>The idea is that the <code>vs()</code> function reflects the special variance structure that each random effect could have:</p>
<p><span class="math inline">\(T \bigotimes E \bigotimes ... \bigotimes A\)</span></p>
<p>where the … argument in the <code>vs()</code> function is used to specify the kronecker products from all matrices that form the variance for the random effect , where the auxiliar function ds(), us(), cs(), at(), can be used to define such structure. The idea is that a variance model for a random effect x (i.e. individuals) might require a more flexible model than just:</p>
<p>random=~x</p>
<p>For example, if individuals are tested in different time-points and environment, we can assume a different variance and covariance components among the individuals in the different environment-timepoint combinations. An example of variance structure of the type:</p>
<p><span class="math inline">\(T \bigotimes E \bigotimes S \bigotimes A\)</span></p>
<p>would be specified in the <code>vs()</code> function as:</p>
<p>random=~vs(us(e),us(s),x, Gu=A, Gtc=T)</p>
<p>where the <code>e</code> would be a column vector in a data frame for the environments, <code>s</code> a vector in the dataframe for the time points, <code>x</code> is the vector in the datrame for the identifier of individuals, <code>A</code> is a known square variance covariance matrix among individuals, and T is a square matrices with as many rows and columns as the number of traits.</p>
<div id="univariate-homogeneous-variance-models" class="section level2">
<h2>1) Univariate homogeneous variance models</h2>
<p>This type of models refer to single response models where a variable of interest (i.e. genotypes) needs to be analized as interacting with a 2nd random effect (i.e. environments), but you assume that across environments the genotypes have the same variance component. This is the so-called compound simmetry (CS) model.</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r"><span class="kw">library</span>(sommer)
<span class="kw">data</span>(DT_example)
<span class="kw">head</span>(DT)</code></pre></div>
<pre><code>##                   Name     Env Loc Year     Block Yield    Weight
## 33  Manistee(MSL292-A) CA.2013  CA 2013 CA.2013.1     4 -1.904711
## 65          CO02024-9W CA.2013  CA 2013 CA.2013.1     5 -1.446958
## 66  Manistee(MSL292-A) CA.2013  CA 2013 CA.2013.2     5 -1.516271
## 67            MSL007-B CA.2011  CA 2011 CA.2011.2     5 -1.435510
## 68           MSR169-8Y CA.2013  CA 2013 CA.2013.1     5 -1.469051
## 103         AC05153-1W CA.2013  CA 2013 CA.2013.1     6 -1.307167</code></pre>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r">ans1 &lt;-<span class="st"> </span><span class="kw">mmer</span>(Yield~Env,
              <span class="dt">random=</span> ~<span class="st"> </span>Name +<span class="st"> </span>Env:Name,
              <span class="dt">rcov=</span> ~<span class="st"> </span>units,
              <span class="dt">data=</span>DT)</code></pre></div>
<pre><code>## iteration    LogLik     wall    cpu(sec)   restrained
##     1      -23.4747   17:34:46      0           0
##     2      -21.0636   17:34:46      0           0
##     3      -20.2304   17:34:46      0           0
##     4      -20.1465   17:34:46      0           0
##     5      -20.1454   17:34:46      0           0
##     6      -20.1454   17:34:46      0           0</code></pre>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r"><span class="kw">summary</span>(ans1)</code></pre></div>
<pre><code>## ============================================================
##          Multivariate Linear Mixed Model fit by REML         
## **********************  sommer 3.7  ********************** 
## ============================================================
##          logLik      AIC      BIC Method Converge
## Value -20.14539 46.29075 55.95182     NR     TRUE
## ============================================================
## Variance-Covariance components:
##                      VarComp VarCompSE Zratio Constraint
## Name.Yield-Yield       3.682    1.6913  2.177   Positive
## Env:Name.Yield-Yield   5.173    1.4955  3.459   Positive
## units.Yield-Yield      4.366    0.6469  6.749   Positive
## ============================================================
## Fixed effects:
##   Trait      Effect Estimate Std.Error t.value
## 1 Yield (Intercept)   16.496    0.6855  24.065
## 2 Yield  EnvCA.2012   -5.777    0.7558  -7.643
## 3 Yield  EnvCA.2013   -6.380    0.7961  -8.015
## ============================================================
## Groups and observations:
##          Yield
## Name        41
## Env:Name   123
## ============================================================
## Use the '$' sign to access results and parameters</code></pre>
</div>
<div id="univariate-heterogeneous-variance-models" class="section level2">
<h2>2) Univariate heterogeneous variance models</h2>
<p>Very often in multi-environment trials, the assumption that the genetic variance or the residual variance is the same across locations may be too naive. Because of that, specifying a general genetic component and a location specific genetic variance is the way to go. This requires a CS+DIAG model (also called heterogeneous CS model).</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r"><span class="kw">data</span>(DT_example)
<span class="kw">head</span>(DT)</code></pre></div>
<pre><code>##                   Name     Env Loc Year     Block Yield    Weight
## 33  Manistee(MSL292-A) CA.2013  CA 2013 CA.2013.1     4 -1.904711
## 65          CO02024-9W CA.2013  CA 2013 CA.2013.1     5 -1.446958
## 66  Manistee(MSL292-A) CA.2013  CA 2013 CA.2013.2     5 -1.516271
## 67            MSL007-B CA.2011  CA 2011 CA.2011.2     5 -1.435510
## 68           MSR169-8Y CA.2013  CA 2013 CA.2013.1     5 -1.469051
## 103         AC05153-1W CA.2013  CA 2013 CA.2013.1     6 -1.307167</code></pre>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r">ans2 &lt;-<span class="st"> </span><span class="kw">mmer</span>(Yield~Env,
              <span class="dt">random=</span> ~Name +<span class="st"> </span><span class="kw">vs</span>(<span class="kw">ds</span>(Env),Name),
              <span class="dt">rcov=</span> ~<span class="st"> </span><span class="kw">vs</span>(<span class="kw">ds</span>(Env),units),
              <span class="dt">data=</span>DT)</code></pre></div>
<pre><code>## iteration    LogLik     wall    cpu(sec)   restrained
##     1      -23.4747   17:34:46      0           0
##     2      -17.9787   17:34:47      1           0
##     3      -15.8441   17:34:47      1           0
##     4      -15.4545   17:34:47      1           0
##     5      -15.4314   17:34:47      1           0
##     6      -15.4299   17:34:47      1           0
##     7      -15.4298   17:34:47      1           0</code></pre>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r"><span class="kw">summary</span>(ans2)</code></pre></div>
<pre><code>## ============================================================
##          Multivariate Linear Mixed Model fit by REML         
## **********************  sommer 3.7  ********************** 
## ============================================================
##          logLik      AIC      BIC Method Converge
## Value -15.42992 36.85966 46.52072     NR     TRUE
## ============================================================
## Variance-Covariance components:
##                           VarComp VarCompSE Zratio Constraint
## Name.Yield-Yield            2.963    1.4969  1.979   Positive
## CA.2011:Name.Yield-Yield   10.145    4.5086  2.250   Positive
## CA.2012:Name.Yield-Yield    1.879    1.8704  1.005   Positive
## CA.2013:Name.Yield-Yield    6.629    2.5025  2.649   Positive
## CA.2011:units.Yield-Yield   4.942    1.5245  3.242   Positive
## CA.2012:units.Yield-Yield   5.724    1.3116  4.365   Positive
## CA.2013:units.Yield-Yield   2.560    0.6398  4.001   Positive
## ============================================================
## Fixed effects:
##   Trait      Effect Estimate Std.Error t.value
## 1 Yield (Intercept)   16.508    0.8268  19.965
## 2 Yield  EnvCA.2012   -5.817    0.8575  -6.783
## 3 Yield  EnvCA.2013   -6.412    0.9356  -6.854
## ============================================================
## Groups and observations:
##              Yield
## Name            41
## CA.2011:Name    41
## CA.2012:Name    41
## CA.2013:Name    41
## ============================================================
## Use the '$' sign to access results and parameters</code></pre>
<p>As you can see the special function <code>at</code> or <code>diag</code> can be used to indicate that there’s a different variance for the genotypes in each environment. Same was done for the residual. The difference between <code>at</code> and <code>diag</code> is that the <code>at</code> function can be used to specify the levels or specific environments where the variance is different.</p>
</div>
<div id="unstructured-variance-models" class="section level2">
<h2>3) Unstructured variance models</h2>
<p>A more relaxed asumption than the CS+DIAG model is the unstructured model (US) which assumes that among the levels of certain factor (i.e. Environments) there’s a covariance struture of a second random effect (i.e. Genotypes). This can be done in sommer using the <code>us(.)</code> function:</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r"><span class="kw">data</span>(DT_example)
<span class="kw">head</span>(DT)</code></pre></div>
<pre><code>##                   Name     Env Loc Year     Block Yield    Weight
## 33  Manistee(MSL292-A) CA.2013  CA 2013 CA.2013.1     4 -1.904711
## 65          CO02024-9W CA.2013  CA 2013 CA.2013.1     5 -1.446958
## 66  Manistee(MSL292-A) CA.2013  CA 2013 CA.2013.2     5 -1.516271
## 67            MSL007-B CA.2011  CA 2011 CA.2011.2     5 -1.435510
## 68           MSR169-8Y CA.2013  CA 2013 CA.2013.1     5 -1.469051
## 103         AC05153-1W CA.2013  CA 2013 CA.2013.1     6 -1.307167</code></pre>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r">ans3 &lt;-<span class="st"> </span><span class="kw">mmer</span>(Yield~Env,
             <span class="dt">random=</span>~<span class="st"> </span><span class="kw">vs</span>(<span class="kw">us</span>(Env),Name),
             <span class="dt">rcov=</span>~<span class="kw">vs</span>(<span class="kw">us</span>(Env),units), 
             <span class="dt">data=</span>DT)</code></pre></div>
<pre><code>## iteration    LogLik     wall    cpu(sec)   restrained
##     1      -20.3368   17:34:47      0           0
##     2      -14.2124   17:34:47      0           0
##     3      -11.8334   17:34:47      0           0
##     4      -11.51   17:34:47      0           0
##     5      -11.5001   17:34:48      1           0
##     6      -11.4997   17:34:48      1           0</code></pre>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r"><span class="kw">summary</span>(ans3)</code></pre></div>
<pre><code>## ===================================================================
##              Multivariate Linear Mixed Model fit by REML             
## **************************  sommer 3.7  ************************** 
## ===================================================================
##          logLik      AIC     BIC Method Converge
## Value -11.50013 28.99943 38.6605     NR     TRUE
## ===================================================================
## Variance-Covariance components:
##                                   VarComp VarCompSE    Zratio Constraint
## CA.2011:Name.Yield-Yield          15.6658 5.423e+00 2.889e+00   Positive
## CA.2012:CA.2011:Name.Yield-Yield   6.1107 2.486e+00 2.458e+00   Unconstr
## CA.2012:Name.Yield-Yield           4.5309 1.822e+00 2.487e+00   Positive
## CA.2013:CA.2011:Name.Yield-Yield   6.3844 3.067e+00 2.082e+00   Unconstr
## CA.2013:CA.2012:Name.Yield-Yield   0.3934 1.524e+00 2.581e-01   Unconstr
## CA.2013:Name.Yield-Yield           8.5972 2.484e+00 3.461e+00   Positive
## CA.2011:units.Yield-Yield          4.9698 1.532e+00 3.244e+00   Positive
## CA.2012:CA.2011:units.Yield-Yield  2.1067 1.437e-15 1.466e+15   Unconstr
## CA.2012:units.Yield-Yield          5.6722 1.300e+00 4.364e+00   Positive
## CA.2013:CA.2011:units.Yield-Yield  2.1067 0.000e+00       Inf   Unconstr
## CA.2013:CA.2012:units.Yield-Yield  2.1067 0.000e+00       Inf   Unconstr
## CA.2013:units.Yield-Yield          2.5571 6.392e-01 4.001e+00   Positive
## ===================================================================
## Fixed effects:
##   Trait      Effect Estimate Std.Error t.value
## 1 Yield (Intercept)   16.331    0.8137  20.069
## 2 Yield  EnvCA.2012   -5.696    0.7404  -7.693
## 3 Yield  EnvCA.2013   -6.271    0.8191  -7.656
## ===================================================================
## Groups and observations:
##                      Yield
## CA.2011:Name            41
## CA.2012:CA.2011:Name    82
## CA.2012:Name            41
## CA.2013:CA.2011:Name    82
## CA.2013:CA.2012:Name    82
## CA.2013:Name            41
## ===================================================================
## Use the '$' sign to access results and parameters</code></pre>
<p>As can be seen the <code>us(Env)</code> indicates that the genotypes (Name) can have a covariance structure among environments (Env).</p>
</div>
<div id="multivariate-homogeneous-variance-models" class="section level2">
<h2>4) Multivariate homogeneous variance models</h2>
<p>Currently there’s a great push for multi-response models. This is motivated by the correlation that certain variables hide and that could benefit in the prediction perspective. In sommer to specify multivariate models the response requires the use of the <code>cbind()</code> function in the response, and the <code>us(trait)</code>, <code>diag(trait)</code>, or <code>at(trait)</code> functions in the random part of the model.</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r"><span class="kw">data</span>(DT_example)
<span class="kw">head</span>(DT)</code></pre></div>
<pre><code>##                   Name     Env Loc Year     Block Yield    Weight
## 33  Manistee(MSL292-A) CA.2013  CA 2013 CA.2013.1     4 -1.904711
## 65          CO02024-9W CA.2013  CA 2013 CA.2013.1     5 -1.446958
## 66  Manistee(MSL292-A) CA.2013  CA 2013 CA.2013.2     5 -1.516271
## 67            MSL007-B CA.2011  CA 2011 CA.2011.2     5 -1.435510
## 68           MSR169-8Y CA.2013  CA 2013 CA.2013.1     5 -1.469051
## 103         AC05153-1W CA.2013  CA 2013 CA.2013.1     6 -1.307167</code></pre>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r">DT$EnvName &lt;-<span class="st"> </span><span class="kw">paste</span>(DT$Env,DT$Name)
ans4 &lt;-<span class="st"> </span><span class="kw">mmer</span>(<span class="kw">cbind</span>(Yield, Weight) ~<span class="st"> </span>Env,
              <span class="dt">random=</span> ~<span class="st"> </span><span class="kw">vs</span>(Name) +<span class="st"> </span><span class="kw">vs</span>(EnvName),
              <span class="dt">rcov=</span> ~<span class="st"> </span><span class="kw">vs</span>(units),
              <span class="dt">data=</span>DT)</code></pre></div>
<pre><code>## iteration    LogLik     wall    cpu(sec)   restrained
##     1      72.7074   17:34:48      0           0
##     2      120.156   17:34:49      1           0
##     3      155.652   17:34:50      2           0
##     4      166.839   17:34:51      3           0
##     5      167.024   17:34:51      3           0
##     6      167.025   17:34:52      4           0
##     7      167.025   17:34:53      5           0</code></pre>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r"><span class="kw">summary</span>(ans4)</code></pre></div>
<pre><code>## ============================================================
##          Multivariate Linear Mixed Model fit by REML         
## **********************  sommer 3.7  ********************** 
## ============================================================
##         logLik       AIC       BIC Method Converge
## Value 167.0252 -322.0505 -298.5695     NR     TRUE
## ============================================================
## Variance-Covariance components:
##                         VarComp VarCompSE Zratio Constraint
## u:Name.Yield-Yield       3.7090   1.68154  2.206   Positive
## u:Name.Yield-Weight      0.9071   0.37953  2.390   Unconstr
## u:Name.Weight-Weight     0.2243   0.08777  2.556   Positive
## u:EnvName.Yield-Yield    5.0922   1.47905  3.443   Positive
## u:EnvName.Yield-Weight   1.0269   0.30773  3.337   Unconstr
## u:EnvName.Weight-Weight  0.2101   0.06662  3.153   Positive
## u:units.Yield-Yield      4.3837   0.64949  6.750   Positive
## u:units.Yield-Weight     0.9077   0.14147  6.417   Unconstr
## u:units.Weight-Weight    0.2280   0.03378  6.751   Positive
## ============================================================
## Fixed effects:
##    Trait      Effect Estimate Std.Error t.value
## 1  Yield (Intercept)  16.4093    0.6783  24.191
## 2 Weight (Intercept)   0.9806    0.1497   6.550
## 3  Yield  EnvCA.2012  -5.6844    0.7474  -7.605
## 4 Weight  EnvCA.2012  -1.1846    0.1593  -7.439
## 5  Yield  EnvCA.2013  -6.2952    0.7850  -8.019
## 6 Weight  EnvCA.2013  -1.3559    0.1681  -8.065
## ============================================================
## Groups and observations:
##           Yield Weight
## u:Name       41     41
## u:EnvName    94     94
## ============================================================
## Use the '$' sign to access results and parameters</code></pre>
<p>You may notice that we have added the <code>us(trait)</code> behind the random effects. This is to indicate the structure that should be assume in the multivariate model. The <code>diag(trait)</code> used behind a random effect (i.e. Name) indicates that for the traits modeled (Yield and Weight) there’s no a covariance component and should not be estimated, whereas <code>us(trait)</code> assumes that for such random effect, there’s a covariance component to be estimated (i.e. covariance between Yield and Weight for the random effect Name). Same applies for the residual part (rcov).</p>
</div>
<div id="multivariate-heterogeneous-variance-models" class="section level2">
<h2>5) Multivariate heterogeneous variance models</h2>
<p>This is just an extension of the univariate heterogeneous variance models but at the multivariate level. This would be a CS+DIAG multivariate model:</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r"><span class="kw">data</span>(DT_example)
<span class="kw">head</span>(DT)</code></pre></div>
<pre><code>##                   Name     Env Loc Year     Block Yield    Weight
## 33  Manistee(MSL292-A) CA.2013  CA 2013 CA.2013.1     4 -1.904711
## 65          CO02024-9W CA.2013  CA 2013 CA.2013.1     5 -1.446958
## 66  Manistee(MSL292-A) CA.2013  CA 2013 CA.2013.2     5 -1.516271
## 67            MSL007-B CA.2011  CA 2011 CA.2011.2     5 -1.435510
## 68           MSR169-8Y CA.2013  CA 2013 CA.2013.1     5 -1.469051
## 103         AC05153-1W CA.2013  CA 2013 CA.2013.1     6 -1.307167</code></pre>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r">DT$EnvName &lt;-<span class="st"> </span><span class="kw">paste</span>(DT$Env,DT$Name)
ans5 &lt;-<span class="st"> </span><span class="kw">mmer</span>(<span class="kw">cbind</span>(Yield, Weight) ~<span class="st"> </span>Env,
              <span class="dt">random=</span> ~<span class="st"> </span><span class="kw">vs</span>(Name) +<span class="st"> </span><span class="kw">vs</span>(<span class="kw">ds</span>(Env),Name),
              <span class="dt">rcov=</span> ~<span class="st"> </span><span class="kw">vs</span>(<span class="kw">ds</span>(Env),units),
              <span class="dt">data=</span>DT)</code></pre></div>
<pre><code>## iteration    LogLik     wall    cpu(sec)   restrained
##     1      72.7074   17:34:55      2           0
##     2      127.145   17:34:57      4           0
##     3      164.877   17:34:58      5           0
##     4      177.275   17:34:59      6           0
##     5      177.759   17:35:0      7           0
##     6      177.806   17:35:2      9           0
##     7      177.814   17:35:3      10           0
##     8      177.815   17:35:5      12           0
##     9      177.815   17:35:7      14           0</code></pre>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r"><span class="kw">summary</span>(ans5)</code></pre></div>
<pre><code>## =============================================================
##           Multivariate Linear Mixed Model fit by REML          
## **********************  sommer 3.7  ********************** 
## =============================================================
##         logLik       AIC       BIC Method Converge
## Value 177.8151 -343.6307 -320.1497     NR     TRUE
## =============================================================
## Variance-Covariance components:
##                             VarComp VarCompSE Zratio Constraint
## u:Name.Yield-Yield          3.31892   1.45282 2.2845   Positive
## u:Name.Yield-Weight         0.79393   0.32626 2.4335   Unconstr
## u:Name.Weight-Weight        0.19088   0.07504 2.5436   Positive
## CA.2011:Name.Yield-Yield    8.70864   4.01547 2.1688   Positive
## CA.2011:Name.Yield-Weight   1.77911   0.83930 2.1197   Unconstr
## CA.2011:Name.Weight-Weight  0.35964   0.17901 2.0090   Positive
## CA.2012:Name.Yield-Yield    2.57514   1.95105 1.3199   Positive
## CA.2012:Name.Yield-Weight   0.33336   0.39873 0.8360   Unconstr
## CA.2012:Name.Weight-Weight  0.03861   0.08602 0.4489   Positive
## CA.2013:Name.Yield-Yield    5.46595   2.16170 2.5285   Positive
## CA.2013:Name.Yield-Weight   1.34633   0.50444 2.6690   Unconstr
## CA.2013:Name.Weight-Weight  0.32882   0.12199 2.6955   Positive
## CA.2011:units.Yield-Yield   4.93854   1.52320 3.2422   Positive
## CA.2011:units.Yield-Weight  0.99447   0.32150 3.0932   Unconstr
## CA.2011:units.Weight-Weight 0.23982   0.07394 3.2433   Positive
## CA.2012:units.Yield-Yield   5.73847   1.31513 4.3634   Positive
## CA.2012:units.Yield-Weight  1.28000   0.30152 4.2452   Unconstr
## CA.2012:units.Weight-Weight 0.31804   0.07285 4.3655   Positive
## CA.2013:units.Yield-Yield   2.56126   0.63993 4.0024   Positive
## CA.2013:units.Yield-Weight  0.44569   0.12645 3.5246   Unconstr
## CA.2013:units.Weight-Weight 0.12232   0.03057 4.0009   Positive
## =============================================================
## Fixed effects:
##    Trait      Effect Estimate Std.Error t.value
## 1  Yield (Intercept)  16.4243    0.7891  20.814
## 2 Weight (Intercept)   0.9866    0.1683   5.863
## 3  Yield  EnvCA.2012  -5.7339    0.8267  -6.936
## 4 Weight  EnvCA.2012  -1.1998    0.1698  -7.066
## 5  Yield  EnvCA.2013  -6.3129    0.8757  -7.209
## 6 Weight  EnvCA.2013  -1.3621    0.1914  -7.115
## =============================================================
## Groups and observations:
##              Yield Weight
## u:Name          41     41
## CA.2011:Name    41     41
## CA.2012:Name    41     41
## CA.2013:Name    41     41
## =============================================================
## Use the '$' sign to access results and parameters</code></pre>
</div>
<div id="multivariate-unstructured-variance-models" class="section level2">
<h2>6) Multivariate unstructured variance models</h2>
<p>This is just an extension of the univariate unstructured variance models but at the multivariate level. This would be a US multivariate model:</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r"><span class="kw">data</span>(DT_example)
<span class="kw">head</span>(DT)</code></pre></div>
<pre><code>##                   Name     Env Loc Year     Block Yield    Weight
## 33  Manistee(MSL292-A) CA.2013  CA 2013 CA.2013.1     4 -1.904711
## 65          CO02024-9W CA.2013  CA 2013 CA.2013.1     5 -1.446958
## 66  Manistee(MSL292-A) CA.2013  CA 2013 CA.2013.2     5 -1.516271
## 67            MSL007-B CA.2011  CA 2011 CA.2011.2     5 -1.435510
## 68           MSR169-8Y CA.2013  CA 2013 CA.2013.1     5 -1.469051
## 103         AC05153-1W CA.2013  CA 2013 CA.2013.1     6 -1.307167</code></pre>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r">DT$EnvName &lt;-<span class="st"> </span><span class="kw">paste</span>(DT$Env,DT$Name)
ans6 &lt;-<span class="st"> </span><span class="kw">mmer</span>(<span class="kw">cbind</span>(Yield, Weight) ~<span class="st"> </span>Env,
              <span class="dt">random=</span> ~<span class="st"> </span><span class="kw">vs</span>(<span class="kw">us</span>(Env),Name),
              <span class="dt">rcov=</span> ~<span class="st"> </span><span class="kw">vs</span>(<span class="kw">ds</span>(Env),units),
              <span class="dt">data=</span>DT)</code></pre></div>
<pre><code>## iteration    LogLik     wall    cpu(sec)   restrained
##     1      82.6331   17:35:9      2           0
##     2      139.835   17:35:10      3           0
##     3      173.247   17:35:12      5           0
##     4      181.246   17:35:14      7           0
##     5      181.631   17:35:16      9           0
##     6      181.721   17:35:19      12           0
##     7      181.757   17:35:21      14           0
##     8      181.774   17:35:23      16           0
##     9      181.783   17:35:25      18           0
##     10      181.788   17:35:27      20           0
##     11      181.791   17:35:29      22           0
##     12      181.793   17:35:32      25           0
##     13      181.794   17:35:34      27           0
##     14      181.794   17:35:36      29           0</code></pre>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r"><span class="kw">summary</span>(ans6)</code></pre></div>
<pre><code>## ====================================================================
##              Multivariate Linear Mixed Model fit by REML             
## **************************  sommer 3.7  ************************** 
## ====================================================================
##         logLik       AIC       BIC Method Converge
## Value 181.7937 -351.5889 -328.1079     NR     TRUE
## ====================================================================
## Variance-Covariance components:
##                                    VarComp VarCompSE Zratio Constraint
## CA.2011:Name.Yield-Yield           15.6464   5.35700  2.921   Positive
## CA.2011:Name.Yield-Weight           3.3589   1.14631  2.930   Unconstr
## CA.2011:Name.Weight-Weight          0.7182   0.24869  2.888   Positive
## CA.2012:CA.2011:Name.Yield-Yield    6.5290   2.48623  2.626   Unconstr
## CA.2012:CA.2011:Name.Yield-Weight   1.3505   0.52388  2.578   Unconstr
## CA.2012:CA.2011:Name.Weight-Weight  0.2842   0.11258  2.524   Unconstr
## CA.2012:Name.Yield-Yield            4.7893   1.86186  2.572   Positive
## CA.2012:Name.Yield-Weight           0.8640   0.38377  2.251   Unconstr
## CA.2012:Name.Weight-Weight          0.1693   0.08354  2.026   Positive
## CA.2013:CA.2011:Name.Yield-Yield    5.9932   2.93849  2.040   Unconstr
## CA.2013:CA.2011:Name.Yield-Weight   1.4232   0.64977  2.190   Unconstr
## CA.2013:CA.2011:Name.Weight-Weight  0.3379   0.14681  2.302   Unconstr
## CA.2013:CA.2012:Name.Yield-Yield    2.1001   1.44051  1.458   Unconstr
## CA.2013:CA.2012:Name.Yield-Weight   0.5243   0.32360  1.620   Unconstr
## CA.2013:CA.2012:Name.Weight-Weight  0.1343   0.07573  1.773   Unconstr
## CA.2013:Name.Yield-Yield            8.6267   2.47859  3.480   Positive
## CA.2013:Name.Yield-Weight           2.1050   0.58760  3.582   Unconstr
## CA.2013:Name.Weight-Weight          0.5126   0.14288  3.588   Positive
## CA.2011:units.Yield-Yield           4.9516   1.52694  3.243   Positive
## CA.2011:units.Yield-Weight          0.9993   0.32285  3.095   Unconstr
## CA.2011:units.Weight-Weight         0.2411   0.07432  3.244   Positive
## CA.2012:units.Yield-Yield           5.7791   1.32428  4.364   Positive
## CA.2012:units.Yield-Weight          1.2914   0.30409  4.247   Unconstr
## CA.2012:units.Weight-Weight         0.3212   0.07356  4.366   Positive
## CA.2013:units.Yield-Yield           2.5567   0.63883  4.002   Positive
## CA.2013:units.Yield-Weight          0.4452   0.12631  3.524   Unconstr
## CA.2013:units.Weight-Weight         0.1223   0.03056  4.001   Positive
## ====================================================================
## Fixed effects:
##    Trait      Effect Estimate Std.Error t.value
## 1  Yield (Intercept)  16.3342    0.8254  19.789
## 2 Weight (Intercept)   0.9677    0.1771   5.466
## 3  Yield  EnvCA.2012  -5.6637    0.7449  -7.603
## 4 Weight  EnvCA.2012  -1.1855    0.1604  -7.389
## 5  Yield  EnvCA.2013  -6.2153    0.8340  -7.452
## 6 Weight  EnvCA.2013  -1.3406    0.1806  -7.425
## ====================================================================
## Groups and observations:
##                      Yield Weight
## CA.2011:Name            41     41
## CA.2012:CA.2011:Name    82     82
## CA.2012:Name            41     41
## CA.2013:CA.2011:Name    82     82
## CA.2013:CA.2012:Name    82     82
## CA.2013:Name            41     41
## ====================================================================
## Use the '$' sign to access results and parameters</code></pre>
<p>Any number of random effects can be specified with different structures.</p>
</div>
<div id="random-regression-models" class="section level2">
<h2>7) Random regression models</h2>
<p>In order to fit random regression models the user can use the <code>leg()</code> function to fit Legendre polynomials. This can be combined with other special covariance structures such as <code>ds()</code>, <code>us()</code>, etc.</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r"><span class="kw">library</span>(orthopolynom)</code></pre></div>
<pre><code>## Loading required package: polynom</code></pre>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r"><span class="kw">data</span>(DT_legendre)
<span class="kw">head</span>(DT)</code></pre></div>
<pre><code>##     SUBJECT X          Y Xf
## 1.1       1 1 -0.7432795  1
## 2.1       2 1 -0.6669945  1
## 3.1       3 1 -4.2802751  1
## 4.1       4 1  4.1092149  1
## 5.1       5 1 -3.0317213  1
## 6.1       6 1  1.3506577  1</code></pre>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r">mRR2&lt;-<span class="kw">mmer</span>(Y~<span class="st"> </span><span class="dv">1</span> +<span class="st"> </span>Xf
           , <span class="dt">random=</span>~<span class="st"> </span><span class="kw">vs</span>(<span class="kw">us</span>(<span class="kw">leg</span>(X,<span class="dv">1</span>)),SUBJECT)
           , <span class="dt">rcov=</span>~<span class="kw">vs</span>(units)
           , <span class="dt">data=</span>DT)</code></pre></div>
<pre><code>## iteration    LogLik     wall    cpu(sec)   restrained
##     1      -166.081   17:35:37      1           0
##     2      -147.588   17:35:37      1           0
##     3      -137.701   17:35:37      1           0
##     4      -136.239   17:35:37      1           0
##     5      -136.222   17:35:38      2           0
##     6      -136.222   17:35:38      2           0</code></pre>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r"><span class="kw">summary</span>(mRR2)$varcomp</code></pre></div>
<pre><code>##                         VarComp VarCompSE   Zratio Constraint
## leg0:SUBJECT.Y-Y      2.5783203 0.6717074 3.838458   Positive
## leg1:leg0:SUBJECT.Y-Y 0.4765587 0.2395195 1.989645   Unconstr
## leg1:SUBJECT.Y-Y      0.3497639 0.2183367 1.601947   Positive
## u:units.Y-Y           2.6911840 0.3824650 7.036420   Positive</code></pre>
<p>Here, a numeric covariate X is used to explain the trajectory of the SUBJECT’s and combined with an unstructured covariance matrix. The details can be found in the theory.</p>
</div>
<div id="gwas-models" class="section level2">
<h2>8) GWAS models</h2>
<p>Although genome wide association studies can be conducted through a variety of approaches, the use of mixed models to find association between markers and phenotypes still one of the most popular approaches. Two of the most classical and popular approaches is to test marker by marker trough mixed modeling (1 model by marker) to obtain the marker effect and an statistic reflecting the level of association usually provided as the -log10 p-value. The second most popular approach is to assume that the genetic variance component is similar for all markers and therefore the variance components are only estimated once (1 model for all markers) and use the inverse of the phenotypic variance matrix (V.inverse) to test all markers in the generalized linear model b=(XV-X)-XV-y. This makes the GWAS much faster and efficient without major loses. Given the straight forward extension, sommer provides the <code>GWAS</code> function which can fit both type of approaches (be aware that these are 2 among many existant in the literature) in univariate and multivariate models, that way genetically correlated traits can be tested together to increase the power of detection.</p>
<p>Here we show a simple GWAS model for an univariate example.</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r"><span class="kw">data</span>(DT_cpdata)
#### create the variance-covariance matrix
A &lt;-<span class="st"> </span><span class="kw">A.mat</span>(GT) <span class="co"># additive relationship matrix</span>
#### look at the data and fit the model
<span class="kw">head</span>(DT,<span class="dv">3</span>)</code></pre></div>
<pre><code>##        id Row Col Year      color  Yield FruitAver Firmness Rowf Colf
## P003 P003   3   1 2014 0.10075269 154.67     41.93  588.917    3    1
## P004 P004   4   1 2014 0.13891940 186.77     58.79  640.031    4    1
## P005 P005   5   1 2014 0.08681502  80.21     48.16  671.523    5    1</code></pre>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r"><span class="kw">head</span>(MP,<span class="dv">3</span>)</code></pre></div>
<pre><code>##                 Locus Position Chrom
## 1  scaffold_77830_839        0     1
## 2  scaffold_39187_895        0     1
## 3 scaffold_50439_2379        0     1</code></pre>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r">GT[<span class="dv">1</span>:<span class="dv">3</span>,<span class="dv">1</span>:<span class="dv">4</span>]</code></pre></div>
<pre><code>##      scaffold_50439_2381 scaffold_39344_153 uneak_3436043 uneak_2632033
## P003                   0                  0             0             1
## P004                   0                  0             0             1
## P005                   0                 -1             0             1</code></pre>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r">mix1 &lt;-<span class="st"> </span><span class="kw">GWAS</span>(color~<span class="dv">1</span>,
             <span class="dt">random=</span>~<span class="kw">vs</span>(id,<span class="dt">Gu=</span>A)
             +<span class="st"> </span>Rowf +<span class="st"> </span>Colf,
             <span class="dt">rcov=</span>~units,
             <span class="dt">data=</span>DT,
             <span class="dt">M=</span>GT, <span class="dt">gTerm =</span> <span class="st">&quot;u:id&quot;</span>)</code></pre></div>
<pre><code>## iteration    LogLik     wall    cpu(sec)   restrained
##     1      -147.849   17:35:40      1           0
##     2      -133.84   17:35:40      1           0
##     3      -117.12   17:35:41      2           0
##     4      -108.621   17:35:41      2           1
##     5      -108.14   17:35:41      2           1
##     6      -108.121   17:35:42      3           1
##     7      -108.12   17:35:42      3           1
## Performing GWAS evaluation</code></pre>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r">ms &lt;-<span class="st"> </span><span class="kw">as.data.frame</span>(<span class="kw">t</span>(mix1$scores))
ms$Locus &lt;-<span class="st"> </span><span class="kw">rownames</span>(ms)
MP2 &lt;-<span class="st"> </span><span class="kw">merge</span>(MP,ms,<span class="dt">by=</span><span class="st">&quot;Locus&quot;</span>,<span class="dt">all.x =</span> <span class="ot">TRUE</span>);
<span class="kw">manhattan</span>(MP2, <span class="dt">pch=</span><span class="dv">20</span>,<span class="dt">cex=</span>.<span class="dv">5</span>, <span class="dt">PVCN =</span> <span class="st">&quot;color score&quot;</span>)</code></pre></div>
<p><img src="data:image/png;base64,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" alt /><!-- --></p>
<p>Be aware that the marker matrix M has to be imputed (no missing data allowed) and make sure that the number of rows in the M matrix is equivalent to the levels of the gTerm specified (i.e. if the gTerm is “id” and has 300 levels or in other words 300 individuals, then M has dimensions 300 x p, being p the number of markers).</p>
</div>
<div id="including-special-functions" class="section level2">
<h2>9) Including special functions</h2>
<p>Including special functions + the major vs() function for special variance models + at() specific levels structure + ds() diagonal structure + us() unstructured + cs() customized structure + overlay() overlayed models + spl2D() two dimensional spline models</p>
<p>In a mixed model framework there’s two types of covariance structures, the unknown and known. An example of a known covariance structure is the relationship matrix among individuals commonly present in plant an animal breeding programs. On the other hand, an example of an unknown covariance structure is in a multi-environment trial the covariance among genotypes in these environments, can be assumed diagonal, compound simmetry or unstructured but any needs to be estimated. In the following section we show how to specify unknow and known covariance structured for the random effects.</p>
</div>
<div id="the-vs-function-and-its-auxiliars-ds-us-at-and-cs" class="section level2">
<h2>the vs() function and its auxiliars ds(), us(), at() and cs()</h2>
<p>The vs() function allows to fit different types of variance models (please take the time to read the documentation of this function). As explained in the introduction to covariance structures section in this document, the terms in the vs() function define the kronecker products that will be performed to define the variance and covariance components to be estimated. For example:</p>
<p>fixed=<sub>cbind(Y1,Y2,Y3)</sub>1 random=~vs(ds(Env),us(Time),Geno, Gu=A, Gtc=unsm(3)) rcov=~vs(ds(Env),us(Time),units)</p>
<p>defines a very complex model for the Geno random effect, where assumes that genotypes in different environments will be independent (diagonal structure using ds() function), but within each environment the different time points hold an unstructured variance-covariance structure (using the us() function), and at the same time a known covariance structure for Geno is specified in the Gu argument (here A is a square matrix provided by the user).</p>
</div>
<div id="the-gtc-argument-for-constraints" class="section level2">
<h2>the Gtc argument for constraints</h2>
<p>At the same time all these is embebbed in a multivariate model and the var-cov model is specified in the Gtc argument, here a full unstructured multivariate model is used by putting a 3x3 matrix in the Gtc argument with the following format:</p>
<p><span class="math display">\[\mathbf{Gtc} = \left[\begin{array}
{rrr}
1 &amp; 2 &amp; 2 \\
0 &amp; 1 &amp; 2 \\
0 &amp; 0 &amp; 1 \\
\end{array}\right]
\]</span></p>
<p>By default, sommer assumes an unstructured model if the Gtc argument is not provided. If the user wanted a DIAG model for the multivariate structure the argument would be Gtc=diag(3) which is again a 3x3 matrix but of a diagonal form:</p>
<p><span class="math display">\[\mathbf{Gtc} = \left[\begin{array}
{rrr}
1 &amp; 0 &amp; 0 \\
0 &amp; 1 &amp; 0 \\
0 &amp; 0 &amp; 1 \\
\end{array}\right]
\]</span> Remember that the numbers of the Gtc argument define the constraint applied in the model (1 positive, 2 unconstrained, 3 fixed)</p>
<p>Estimating a DIAG unknown covariance structure among genotypes in different environments (using the ds() function), same for residuals, and using a known covariance structure among genotypes (additive relationship matrix A applied in the Gu argument of the vs function).</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r"><span class="kw">data</span>(DT_example)
<span class="kw">head</span>(DT)</code></pre></div>
<pre><code>##                   Name     Env Loc Year     Block Yield    Weight
## 33  Manistee(MSL292-A) CA.2013  CA 2013 CA.2013.1     4 -1.904711
## 65          CO02024-9W CA.2013  CA 2013 CA.2013.1     5 -1.446958
## 66  Manistee(MSL292-A) CA.2013  CA 2013 CA.2013.2     5 -1.516271
## 67            MSL007-B CA.2011  CA 2011 CA.2011.2     5 -1.435510
## 68           MSR169-8Y CA.2013  CA 2013 CA.2013.1     5 -1.469051
## 103         AC05153-1W CA.2013  CA 2013 CA.2013.1     6 -1.307167</code></pre>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r">ans2 &lt;-<span class="st"> </span><span class="kw">mmer</span>(Yield~Env,
              <span class="dt">random=</span> ~<span class="st"> </span><span class="kw">vs</span>(<span class="kw">ds</span>(Env),Name, <span class="dt">Gu=</span>A),
              <span class="dt">rcov=</span> ~<span class="st"> </span><span class="kw">vs</span>(<span class="kw">ds</span>(Env),units),
              <span class="dt">data=</span>DT)</code></pre></div>
<pre><code>## iteration    LogLik     wall    cpu(sec)   restrained
##     1      -24.4279   17:36:6      0           0
##     2      -19.9461   17:36:6      0           0
##     3      -18.511   17:36:6      0           0
##     4      -18.3462   17:36:6      0           0
##     5      -18.3431   17:36:6      0           0
##     6      -18.343   17:36:6      0           0</code></pre>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r"><span class="kw">summary</span>(ans2)</code></pre></div>
<pre><code>## ============================================================
##          Multivariate Linear Mixed Model fit by REML         
## **********************  sommer 3.7  ********************** 
## ============================================================
##          logLik      AIC      BIC Method Converge
## Value -18.34307 42.68598 52.34705     NR     TRUE
## ============================================================
## Variance-Covariance components:
##                           VarComp VarCompSE Zratio Constraint
## CA.2011:Name.Yield-Yield   17.214    6.1572  2.796   Positive
## CA.2012:Name.Yield-Yield    4.598    1.8373  2.503   Positive
## CA.2013:Name.Yield-Yield    8.790    2.5465  3.452   Positive
## CA.2011:units.Yield-Yield   4.954    1.5284  3.241   Positive
## CA.2012:units.Yield-Yield   5.662    1.2974  4.364   Positive
## CA.2013:units.Yield-Yield   2.557    0.6392  4.000   Positive
## ============================================================
## Fixed effects:
##   Trait      Effect Estimate Std.Error t.value
## 1 Yield (Intercept)   16.622    0.9485  17.525
## 2 Yield  EnvCA.2012   -5.969    1.0447  -5.713
## 3 Yield  EnvCA.2013   -6.659    1.0981  -6.064
## ============================================================
## Groups and observations:
##              Yield
## CA.2011:Name    41
## CA.2012:Name    41
## CA.2013:Name    41
## ============================================================
## Use the '$' sign to access results and parameters</code></pre>
<p>and for multivariate models:</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r"><span class="kw">data</span>(DT_example)
<span class="kw">head</span>(DT)</code></pre></div>
<pre><code>##                   Name     Env Loc Year     Block Yield    Weight
## 33  Manistee(MSL292-A) CA.2013  CA 2013 CA.2013.1     4 -1.904711
## 65          CO02024-9W CA.2013  CA 2013 CA.2013.1     5 -1.446958
## 66  Manistee(MSL292-A) CA.2013  CA 2013 CA.2013.2     5 -1.516271
## 67            MSL007-B CA.2011  CA 2011 CA.2011.2     5 -1.435510
## 68           MSR169-8Y CA.2013  CA 2013 CA.2013.1     5 -1.469051
## 103         AC05153-1W CA.2013  CA 2013 CA.2013.1     6 -1.307167</code></pre>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r">ans2 &lt;-<span class="st"> </span><span class="kw">mmer</span>(<span class="kw">cbind</span>(Yield,Weight)~Env,
              <span class="dt">random=</span> ~<span class="st"> </span><span class="kw">vs</span>(<span class="kw">ds</span>(Env),Name, <span class="dt">Gu=</span>A, <span class="dt">Gtc=</span><span class="kw">unsm</span>(<span class="dv">2</span>)),
              <span class="dt">rcov=</span> ~<span class="st"> </span><span class="kw">vs</span>(<span class="kw">ds</span>(Env),units, <span class="dt">Gtc=</span><span class="kw">diag</span>(<span class="dv">2</span>)),
              <span class="dt">data=</span>DT)</code></pre></div>
<pre><code>## iteration    LogLik     wall    cpu(sec)   restrained
##     1      73.0365   17:36:7      1           0
##     2      18.4838   17:36:8      2           0
##     3      68.5226   17:36:9      3           0
##     4      91.8798   17:36:10      4           0
##     5      92.4904   17:36:11      5           0
##     6      92.4963   17:36:12      6           0
##     7      92.4963   17:36:13      7           0</code></pre>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r"><span class="kw">summary</span>(ans2)</code></pre></div>
<pre><code>## =============================================================
##           Multivariate Linear Mixed Model fit by REML          
## **********************  sommer 3.7  ********************** 
## =============================================================
##         logLik       AIC       BIC Method Converge
## Value 92.49628 -172.9927 -149.5116     NR     TRUE
## =============================================================
## Variance-Covariance components:
##                             VarComp VarCompSE Zratio Constraint
## CA.2011:Name.Yield-Yield    17.2100   6.12625  2.809   Positive
## CA.2011:Name.Yield-Weight    4.1997   1.30600  3.216   Unconstr
## CA.2011:Name.Weight-Weight   0.7979   0.28585  2.791   Positive
## CA.2012:Name.Yield-Yield     4.9115   1.87432  2.620   Positive
## CA.2012:Name.Yield-Weight    1.5623   0.36982  4.224   Unconstr
## CA.2012:Name.Weight-Weight   0.2031   0.08881  2.286   Positive
## CA.2013:Name.Yield-Yield     8.7891   2.53797  3.463   Positive
## CA.2013:Name.Yield-Weight    2.3723   0.60099  3.947   Unconstr
## CA.2013:Name.Weight-Weight   0.5259   0.14763  3.562   Positive
## CA.2011:units.Yield-Yield    4.8687   1.49431  3.258   Positive
## CA.2011:units.Weight-Weight  0.2363   0.07249  3.259   Positive
## CA.2012:units.Yield-Yield    5.4931   1.25622  4.373   Positive
## CA.2012:units.Weight-Weight  0.3031   0.06925  4.377   Positive
## CA.2013:units.Yield-Yield    2.5280   0.62975  4.014   Positive
## CA.2013:units.Weight-Weight  0.1209   0.03014  4.010   Positive
## =============================================================
## Fixed effects:
##    Trait      Effect Estimate Std.Error t.value
## 1  Yield (Intercept)   16.623    0.9463  17.566
## 2 Weight (Intercept)    1.035    0.2044   5.065
## 3  Yield  EnvCA.2012   -5.949    1.0454  -5.691
## 4 Weight  EnvCA.2012   -1.251    0.2256  -5.547
## 5  Yield  EnvCA.2013   -6.661    1.0958  -6.078
## 6 Weight  EnvCA.2013   -1.445    0.2440  -5.923
## =============================================================
## Groups and observations:
##              Yield Weight
## CA.2011:Name    41     41
## CA.2012:Name    41     41
## CA.2013:Name    41     41
## =============================================================
## Use the '$' sign to access results and parameters</code></pre>
</div>
<div id="customized-random-effects" class="section level2">
<h2>customized random effects</h2>
<p>One of the most powerful features of sommer is the ability to provide any customized matrix and estimate any random effect. For example:</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r"><span class="kw">data</span>(DT_cpdata)
GT[<span class="dv">1</span>:<span class="dv">4</span>,<span class="dv">1</span>:<span class="dv">4</span>]</code></pre></div>
<pre><code>##      scaffold_50439_2381 scaffold_39344_153 uneak_3436043 uneak_2632033
## P003                   0                  0             0             1
## P004                   0                  0             0             1
## P005                   0                 -1             0             1
## P006                  -1                 -1            -1             0</code></pre>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r">#### look at the data and fit the model
mix1 &lt;-<span class="st"> </span><span class="kw">mmer</span>(Yield~<span class="dv">1</span>,
              <span class="dt">random=</span>~<span class="kw">vs</span>(<span class="kw">list</span>(GT)),
              <span class="dt">rcov=</span>~units,
              <span class="dt">data=</span>DT)</code></pre></div>
<pre><code>## iteration    LogLik     wall    cpu(sec)   restrained
##     1      -294.169   17:36:15      2           0
##     2      -240.607   17:36:15      2           0
##     3      -202.248   17:36:15      2           0
##     4      -180.448   17:36:16      3           0
##     5      -176.432   17:36:16      3           0
##     6      -176.212   17:36:16      3           0
##     7      -176.207   17:36:17      4           0
##     8      -176.207   17:36:17      4           0</code></pre>
<p>the matrix GT is provided as a random effect by encapsulating the matrix in a list and provided in the <code>vs()</code> function.</p>
</div>
<div id="the-overlay-function" class="section level2">
<h2>the overlay() function</h2>
<p>Another very useful function is the <code>overlay</code> function, which allows to overlay matrices of different random effects and estimate a single variance component for the overlayed terms.</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r"><span class="kw">data</span>(<span class="st">&quot;DT_halfdiallel&quot;</span>)
<span class="kw">head</span>(DT)</code></pre></div>
<pre><code>##   rep geno male female     sugar
## 1   1   12    1      2 13.950509
## 2   2   12    1      2  9.756918
## 3   1   13    1      3 13.906355
## 4   2   13    1      3  9.119455
## 5   1   14    1      4  5.174483
## 6   2   14    1      4  8.452221</code></pre>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r">DT$femalef &lt;-<span class="st"> </span><span class="kw">as.factor</span>(DT$female)
DT$malef &lt;-<span class="st"> </span><span class="kw">as.factor</span>(DT$male)
DT$genof &lt;-<span class="st"> </span><span class="kw">as.factor</span>(DT$geno)
#### model using overlay
modh &lt;-<span class="st"> </span><span class="kw">mmer</span>(sugar~<span class="dv">1</span>, 
             <span class="dt">random=</span>~<span class="kw">vs</span>(<span class="kw">overlay</span>(DT$femalef,DT$malef)) 
             +<span class="st"> </span>genof,
             <span class="dt">data=</span>DT)</code></pre></div>
<pre><code>## iteration    LogLik     wall    cpu(sec)   restrained
##     1      -7.04379   17:36:30      0           0
##     2      -6.09505   17:36:30      0           0
##     3      -5.71831   17:36:30      0           0
##     4      -5.67487   17:36:30      0           0
##     5      -5.67441   17:36:30      0           0</code></pre>
<p>here the femalef and malef random effects are overlayed becoming a single random effect that has the same variance component.</p>
</div>
<div id="the-spl2d-function-using-the-2-dimensional-spline" class="section level2">
<h2>the spl2D() function (using the 2-dimensional spline)</h2>
<p>We will use the CPdata to show the use of 2-dimensional splines for accomodating spatial effects in field experiments. In early generation variety trials the availability of seed is low, which makes the use of unreplicated design a neccesity more than anything else. Experimental designs such as augmented designs and partially-replicated (p-rep) designs become every day more common this days.</p>
<p>In order to do a good job modeling the spatial trends happening in the field special covariance structures have been proposed to accomodate such spatial trends (i.e. autoregressive residuals; ar1). Unfortunately, some of these covariance structures make the modeling rather unstable. More recently other research groups have proposed the use of 2-dimensional splines to overcome such issues and have a more robust modeling of the spatial terms (Lee et al. 2013; Rodríguez-Álvarez et al. 2018).</p>
<p>In this example we assume an unreplicated population where row and range information is available which allows us to fit a 2 dimensional spline model.</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r"><span class="kw">data</span>(<span class="st">&quot;DT_cpdata&quot;</span>)
### mimic two fields
A &lt;-<span class="st"> </span><span class="kw">A.mat</span>(GT)
mix &lt;-<span class="st"> </span><span class="kw">mmer</span>(Yield~<span class="dv">1</span>,
            <span class="dt">random=</span>~<span class="kw">vs</span>(id, <span class="dt">Gu=</span>A) +
<span class="st">              </span><span class="kw">vs</span>(Rowf) +
<span class="st">              </span><span class="kw">vs</span>(Colf) +
<span class="st">              </span><span class="kw">vs</span>(<span class="kw">spl2D</span>(Row,Col)),
            <span class="dt">rcov=</span>~<span class="kw">vs</span>(units),
            <span class="dt">data=</span>DT)</code></pre></div>
<pre><code>## iteration    LogLik     wall    cpu(sec)   restrained
##     1      -189.212   17:36:32      1           0
##     2      -168.339   17:36:32      1           0
##     3      -154.84   17:36:33      2           0
##     4      -151.445   17:36:34      3           0
##     5      -151.225   17:36:34      3           0
##     6      -151.203   17:36:35      4           0
##     7      -151.201   17:36:36      5           0
##     8      -151.201   17:36:37      6           0</code></pre>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r"><span class="kw">summary</span>(mix)</code></pre></div>
<pre><code>## ============================================================
##          Multivariate Linear Mixed Model fit by REML         
## **********************  sommer 3.7  ********************** 
## ============================================================
##          logLik      AIC      BIC Method Converge
## Value -151.2012 304.4021 308.2937     NR     TRUE
## ============================================================
## Variance-Covariance components:
##                     VarComp VarCompSE Zratio Constraint
## u:id.Yield-Yield      783.3     319.2 2.4540   Positive
## u:Rowf.Yield-Yield    814.9     391.0 2.0840   Positive
## u:Colf.Yield-Yield    182.2     129.6 1.4056   Positive
## u:Row.Yield-Yield     513.4     694.4 0.7393   Positive
## u:units.Yield-Yield  2922.7     294.1 9.9365   Positive
## ============================================================
## Fixed effects:
##   Trait      Effect Estimate Std.Error t.value
## 1 Yield (Intercept)    132.1     8.792   15.03
## ============================================================
## Groups and observations:
##        Yield
## u:id     363
## u:Rowf    13
## u:Colf    36
## u:Row    168
## ============================================================
## Use the '$' sign to access results and parameters</code></pre>
<p>Notice that the job is done by the <code>spl2D()</code> function that takes the Row and Col information to fit a spatial kernel.</p>
</div>
<div id="the-specification-of-constraints" class="section level2">
<h2>10) The specification of constraints</h2>
<p>One of the major strengths of sommer is its extreme flexibility to specify variance-covariance structures in the multi-trait framework. Since sommer 3.7 this is easily achieved by the use of the <code>vs()</code> function and it’s argument <code>Gtc</code>. The idea behind how to specify the constraints has been explained in section 7) and here we will only show some examples.</p>
<p>Some useful function to create contrained matrices quickly are <code>unsm()</code> for unstructured, <code>uncm</code> for unconstrained, <code>fixm()</code> for fixed constraint, and <code>fcm()</code> for fixed effect constrains and it’s use is very easy:</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r"><span class="kw">unsm</span>(<span class="dv">4</span>)</code></pre></div>
<pre><code>##      [,1] [,2] [,3] [,4]
## [1,]    1    2    2    2
## [2,]    2    1    2    2
## [3,]    2    2    1    2
## [4,]    2    2    2    1</code></pre>
<p>can be used in vs(x,Gtc=unsm(4)) to specify unstructured model for RE x</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r"><span class="kw">uncm</span>(<span class="dv">4</span>)</code></pre></div>
<pre><code>##      [,1] [,2] [,3] [,4]
## [1,]    2    2    2    2
## [2,]    2    2    2    2
## [3,]    2    2    2    2
## [4,]    2    2    2    2</code></pre>
<p>can be used in vs(x,Gtc=uncm(4)) to specify unconstrained model for RE x</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r"><span class="kw">fixm</span>(<span class="dv">4</span>)</code></pre></div>
<pre><code>##      [,1] [,2] [,3] [,4]
## [1,]    3    3    3    3
## [2,]    0    3    3    3
## [3,]    0    0    3    3
## [4,]    0    0    0    3</code></pre>
<p>can be used in vs(x,Gtc=fixm(4),Gt=mm) to specify a fixed var-cov model for RE x and Gt needs to be provided</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r"><span class="kw">fcm</span>(<span class="kw">c</span>(<span class="dv">1</span>,<span class="dv">0</span>,<span class="dv">1</span>,<span class="dv">0</span>))</code></pre></div>
<pre><code>##      [,1] [,2]
## [1,]    1    0
## [2,]    0    0
## [3,]    0    1
## [4,]    0    0</code></pre>
<p>can be used in vs(xf,Gtc=fcm(c(1,0,1,0))) to specify that the fixed effect xf should be only estimated for traits 1 and 3</p>
<p>A matrix can combine the different constraints (0: not estimated, 1: positive, 2:unconstrained, 3:fixed) as desired.</p>
<p>First we show how to fit fixed effects for an specific trait. Here we assume two traits (Yield and Weight) and a fixed effect called “Env”, which we only want to fit for the trait number 2 and defaults for the random effects.</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r"><span class="kw">data</span>(DT_example)
ansf &lt;-<span class="st"> </span><span class="kw">mmer</span>(<span class="kw">cbind</span>(Yield,Weight)~<span class="kw">vs</span>(Env,<span class="dt">Gtc=</span><span class="kw">fcm</span>(<span class="kw">c</span>(<span class="dv">0</span>,<span class="dv">1</span>))),
             <span class="dt">random=</span> ~<span class="st"> </span><span class="kw">vs</span>(<span class="kw">ds</span>(Env),Name),
             <span class="dt">rcov=</span> ~<span class="st"> </span><span class="kw">vs</span>(<span class="kw">ds</span>(Env),units),
             <span class="dt">data=</span>DT)</code></pre></div>
<pre><code>## iteration    LogLik     wall    cpu(sec)   restrained
##     1      33.8266   17:36:43      4           0
##     2      102.773   17:36:46      7           0
##     3      143.579   17:36:50      11           0
##     4      156.074   17:36:52      13           0
##     5      158.023   17:36:54      15           0
##     6      158.868   17:36:56      17           0
##     7      159.257   17:36:57      18           0
##     8      159.432   17:36:59      20           0
##     9      159.51   17:37:0      21           0
##     10      159.545   17:37:2      23           0
##     11      159.561   17:37:3      24           0
##     12      159.567   17:37:5      26           0
##     13      159.57   17:37:6      27           0
##     14      159.572   17:37:8      29           0
##     15      159.572   17:37:9      30           0</code></pre>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r"><span class="kw">summary</span>(ansf)</code></pre></div>
<pre><code>## =============================================================
##           Multivariate Linear Mixed Model fit by REML          
## **********************  sommer 3.7  ********************** 
## =============================================================
##         logLik       AIC       BIC Method Converge
## Value 159.5718 -311.1448 -295.4908     NR     TRUE
## =============================================================
## Variance-Covariance components:
##                             VarComp VarCompSE Zratio Constraint
## CA.2011:Name.Yield-Yield    51.6351  16.40155  3.148   Positive
## CA.2011:Name.Yield-Weight   11.0588   3.50866  3.152   Unconstr
## CA.2011:Name.Weight-Weight   2.3662   0.75361  3.140   Positive
## CA.2012:Name.Yield-Yield     4.5017   1.81385  2.482   Positive
## CA.2012:Name.Yield-Weight    0.8621   0.38456  2.242   Unconstr
## CA.2012:Name.Weight-Weight   0.1824   0.08619  2.117   Positive
## CA.2013:Name.Yield-Yield     9.1116   2.60811  3.494   Positive
## CA.2013:Name.Yield-Weight    2.2282   0.62058  3.590   Unconstr
## CA.2013:Name.Weight-Weight   0.5432   0.15137  3.588   Positive
## CA.2011:units.Yield-Yield    4.9660   1.53246  3.241   Positive
## CA.2011:units.Yield-Weight   1.0013   0.32371  3.093   Unconstr
## CA.2011:units.Weight-Weight  0.2413   0.07445  3.241   Positive
## CA.2012:units.Yield-Yield    5.6712   1.29969  4.364   Positive
## CA.2012:units.Yield-Weight   1.2616   0.29732  4.243   Unconstr
## CA.2012:units.Weight-Weight  0.3131   0.07174  4.365   Positive
## CA.2013:units.Yield-Yield    2.5508   0.63739  4.002   Positive
## CA.2013:units.Yield-Weight   0.4438   0.12600  3.522   Unconstr
## CA.2013:units.Weight-Weight  0.1220   0.03050  4.001   Positive
## =============================================================
## Fixed effects:
##    Trait      Effect  Estimate Std.Error t.value
## 1  Yield (Intercept) 10.678099   0.33613 31.7678
## 2 Weight (Intercept) -0.233710   0.07736 -3.0209
## 3 Weight  EnvCA.2012  0.017250   0.04188  0.4118
## 4 Weight  EnvCA.2013 -0.008683   0.04116 -0.2110
## =============================================================
## Groups and observations:
##              Yield Weight
## CA.2011:Name    41     41
## CA.2012:Name    41     41
## CA.2013:Name    41     41
## =============================================================
## Use the '$' sign to access results and parameters</code></pre>
<p>Now we specify an unstructured model for the random effect Name and the residuals and after a diagonal for both.</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r"><span class="kw">data</span>(DT_example)
ans.uns &lt;-<span class="st"> </span><span class="kw">mmer</span>(<span class="kw">cbind</span>(Yield,Weight)~Env,
             <span class="dt">random=</span> ~<span class="st"> </span><span class="kw">vs</span>(Name,<span class="dt">Gtc=</span><span class="kw">unsm</span>(<span class="dv">2</span>)),
             <span class="dt">rcov=</span> ~<span class="st"> </span><span class="kw">vs</span>(units,<span class="dt">Gtc=</span><span class="kw">unsm</span>(<span class="dv">2</span>)),
             <span class="dt">data=</span>DT)</code></pre></div>
<pre><code>## iteration    LogLik     wall    cpu(sec)   restrained
##     1      52.3292   17:37:10      1           0
##     2      107.273   17:37:10      1           0
##     3      142.651   17:37:11      2           0
##     4      154.389   17:37:11      2           0
##     5      154.654   17:37:12      3           0
##     6      154.655   17:37:12      3           0
##     7      154.655   17:37:13      4           0</code></pre>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r"><span class="kw">summary</span>(ans.uns)</code></pre></div>
<pre><code>## ============================================================
##          Multivariate Linear Mixed Model fit by REML         
## **********************  sommer 3.7  ********************** 
## ============================================================
##         logLik       AIC       BIC Method Converge
## Value 154.6554 -297.3108 -273.8298     NR     TRUE
## ============================================================
## Variance-Covariance components:
##                       VarComp VarCompSE Zratio Constraint
## u:Name.Yield-Yield     4.8593   1.52191  3.193   Positive
## u:Name.Yield-Weight    1.1432   0.34858  3.280   Unconstr
## u:Name.Weight-Weight   0.2737   0.08164  3.352   Positive
## u:units.Yield-Yield    8.1017   0.96030  8.437   Positive
## u:units.Yield-Weight   1.6523   0.20196  8.181   Unconstr
## u:units.Weight-Weight  0.3792   0.04497  8.432   Positive
## ============================================================
## Fixed effects:
##    Trait      Effect Estimate Std.Error t.value
## 1  Yield (Intercept)  16.3396    0.5824  28.058
## 2 Weight (Intercept)   0.9641    0.1313   7.345
## 3  Yield  EnvCA.2012  -5.6429    0.5712  -9.878
## 4 Weight  EnvCA.2012  -1.1739    0.1245  -9.429
## 5  Yield  EnvCA.2013  -6.1768    0.6064 -10.186
## 6 Weight  EnvCA.2013  -1.3292    0.1327 -10.019
## ============================================================
## Groups and observations:
##        Yield Weight
## u:Name    41     41
## ============================================================
## Use the '$' sign to access results and parameters</code></pre>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r">ans.diag &lt;-<span class="st"> </span><span class="kw">mmer</span>(<span class="kw">cbind</span>(Yield,Weight)~Env,
             <span class="dt">random=</span> ~<span class="st"> </span><span class="kw">vs</span>(Name,<span class="dt">Gtc=</span><span class="kw">diag</span>(<span class="dv">2</span>)),
             <span class="dt">rcov=</span> ~<span class="st"> </span><span class="kw">vs</span>(units,<span class="dt">Gtc=</span><span class="kw">diag</span>(<span class="dv">2</span>)),
             <span class="dt">data=</span>DT)</code></pre></div>
<pre><code>## iteration    LogLik     wall    cpu(sec)   restrained
##     1      52.3292   17:37:14      1           0
##     2      -73.3297   17:37:14      1           0
##     3      -65.0646   17:37:14      1           0
##     4      -63.8193   17:37:15      2           0
##     5      -63.815   17:37:15      2           0
##     6      -63.815   17:37:16      3           0</code></pre>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r"><span class="kw">summary</span>(ans.diag)</code></pre></div>
<pre><code>## ============================================================
##          Multivariate Linear Mixed Model fit by REML         
## **********************  sommer 3.7  ********************** 
## ============================================================
##          logLik      AIC      BIC Method Converge
## Value -63.81504 139.6301 163.1111     NR     TRUE
## ============================================================
## Variance-Covariance components:
##                       VarComp VarCompSE Zratio Constraint
## u:Name.Yield-Yield     4.8559   1.52342  3.188   Positive
## u:Name.Weight-Weight   0.2733   0.08159  3.350   Positive
## u:units.Yield-Yield    8.1086   0.96146  8.434   Positive
## u:units.Weight-Weight  0.3793   0.04499  8.432   Positive
## ============================================================
## Fixed effects:
##    Trait      Effect Estimate Std.Error t.value
## 1  Yield (Intercept)  16.3850    0.5849  28.012
## 2 Weight (Intercept)   0.9661    0.1313   7.359
## 3  Yield  EnvCA.2012  -5.6880    0.5741  -9.908
## 4 Weight  EnvCA.2012  -1.1756    0.1246  -9.437
## 5  Yield  EnvCA.2013  -6.2183    0.6107 -10.182
## 6 Weight  EnvCA.2013  -1.3304    0.1328 -10.021
## ============================================================
## Groups and observations:
##        Yield Weight
## u:Name    41     41
## ============================================================
## Use the '$' sign to access results and parameters</code></pre>
<p>As a final example we will fit a multivariate model to deal with separate sexes which is a common problem in animal genetics.</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r"><span class="co"># Generate some fake data: </span>
<span class="co"># 100 males and 100 females</span>
<span class="co"># Two traits are measured on each male, and two traits on each female</span>
<span class="co"># 20 individuals per sex are measured for each of 5 different genotypes </span>
<span class="kw">set.seed</span>(<span class="dv">3434</span>)
df &lt;-<span class="st"> </span><span class="kw">data.frame</span>(
  <span class="dt">sex =</span> <span class="kw">rep</span>(<span class="kw">c</span>(<span class="st">&quot;female&quot;</span>, <span class="st">&quot;male&quot;</span>), <span class="dt">each =</span> <span class="dv">100</span>),
  <span class="dt">female_trait_1 =</span> <span class="kw">c</span>(<span class="kw">rnorm</span>(<span class="dv">100</span>), <span class="kw">rep</span>(<span class="ot">NA</span>, <span class="dv">100</span>)),
  <span class="dt">female_trait_2 =</span> <span class="kw">c</span>(<span class="kw">rnorm</span>(<span class="dv">100</span>), <span class="kw">rep</span>(<span class="ot">NA</span>, <span class="dv">100</span>)),
  <span class="dt">male_trait_1 =</span> <span class="kw">c</span>(<span class="kw">rep</span>(<span class="ot">NA</span>, <span class="dv">100</span>), <span class="kw">rnorm</span>(<span class="dv">100</span>)),
  <span class="dt">male_trait_2 =</span> <span class="kw">c</span>(<span class="kw">rep</span>(<span class="ot">NA</span>, <span class="dv">100</span>), <span class="kw">rnorm</span>(<span class="dv">100</span>)),
  <span class="dt">genotype =</span> <span class="kw">rep</span>(<span class="kw">rep</span>(<span class="dv">1</span>:<span class="dv">5</span>, <span class="dt">each =</span> <span class="dv">20</span>), <span class="dv">2</span>),
  <span class="dt">individual =</span> <span class="dv">1</span>:<span class="dv">200</span>
)
df$genotype &lt;-<span class="st"> </span><span class="kw">as.factor</span>(df$genotype)
df$individual &lt;-<span class="st"> </span><span class="kw">as.factor</span>(df$individual)

mm &lt;-<span class="st"> </span><span class="kw">adiag1</span>(<span class="kw">unsm</span>(<span class="dv">2</span>),<span class="kw">unsm</span>(<span class="dv">2</span>));mm</code></pre></div>
<pre><code>##      [,1] [,2] [,3] [,4]
## [1,]    1    2    0    0
## [2,]    2    1    0    0
## [3,]    0    0    1    2
## [4,]    0    0    2    1</code></pre>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r"><span class="co"># mix &lt;- mmer(cbind(female_trait_1, </span>
<span class="co">#                   female_trait_2,</span>
<span class="co">#                   male_trait_1,</span>
<span class="co">#                   male_trait_2) ~ 1,</span>
<span class="co">#             random=~vs(genotype,Gtc=unsm(4)) + vs(individual,Gtc=mm),</span>
<span class="co">#             rcov=~vs(units), na.method.Y = &quot;include&quot;,</span>
<span class="co">#             data=df)</span>
<span class="co"># summary(mix)</span></code></pre></div>
<p>I have silenced this colde because data is not meaningful but this must show the way.</p>
</div>
<div id="final-remarks" class="section level2">
<h2>11) Final remarks</h2>
<p>Keep in mind that sommer uses direct inversion (DI) algorithm which can be very slow for large datasets. The package is focused in problems of the type p &gt; n (more random effect levels than observations) and models with dense covariance structures. For example, for experiment with dense covariance structures with low-replication (i.e. 2000 records from 1000 individuals replicated twice with a covariance structure of 1000x1000) sommer will be faster than MME-based software. Also for genomic problems with large number of random effect levels, i.e. 300 individuals (n) with 100,000 genetic markers (p). For highly replicated trials with small covariance structures or n &gt; p (i.e. 2000 records from 200 individuals replicated 10 times with covariance structure of 200x200) asreml or other MME-based algorithms will be much faster and we recommend you to opt for those software.</p>
</div>
<div id="literature" class="section level2">
<h2>Literature</h2>
<p>Covarrubias-Pazaran G. 2016. Genome assisted prediction of quantitative traits using the R package sommer. PLoS ONE 11(6):1-15.</p>
<p>Covarrubias-Pazaran G. 2018. Software update: Moving the R package sommer to multivariate mixed models for genome-assisted prediction. doi: <a href="https://doi.org/10.1101/354639" class="uri">https://doi.org/10.1101/354639</a></p>
<p>Bernardo Rex. 2010. Breeding for quantitative traits in plants. Second edition. Stemma Press. 390 pp.</p>
<p>Gilmour et al. 1995. Average Information REML: An efficient algorithm for variance parameter estimation in linear mixed models. Biometrics 51(4):1440-1450.</p>
<p>Henderson C.R. 1975. Best Linear Unbiased Estimation and Prediction under a Selection Model. Biometrics vol. 31(2):423-447.</p>
<p>Kang et al. 2008. Efficient control of population structure in model organism association mapping. Genetics 178:1709-1723.</p>
<p>Lee, D.-J., Durban, M., and Eilers, P.H.C. (2013). Efficient two-dimensional smoothing with P-spline ANOVA mixed models and nested bases. Computational Statistics and Data Analysis, 61, 22 - 37.</p>
<p>Lee et al. 2015. MTG2: An efficient algorithm for multivariate linear mixed model analysis based on genomic information. Cold Spring Harbor. doi: <a href="http://dx.doi.org/10.1101/027201" class="uri">http://dx.doi.org/10.1101/027201</a>.</p>
<p>Maier et al. 2015. Joint analysis of psychiatric disorders increases accuracy of risk prediction for schizophrenia, bipolar disorder, and major depressive disorder. Am J Hum Genet; 96(2):283-294.</p>
<p>Rodriguez-Alvarez, Maria Xose, et al. Correcting for spatial heterogeneity in plant breeding experiments with P-splines. Spatial Statistics 23 (2018): 52-71.</p>
<p>Searle. 1993. Applying the EM algorithm to calculating ML and REML estimates of variance components. Paper invited for the 1993 American Statistical Association Meeting, San Francisco.</p>
<p>Yu et al. 2006. A unified mixed-model method for association mapping that accounts for multiple levels of relatedness. Genetics 38:203-208.</p>
<p>Abdollahi Arpanahi R, Morota G, Valente BD, Kranis A, Rosa GJM, Gianola D. 2015. Assessment of bagging GBLUP for whole genome prediction of broiler chicken traits. Journal of Animal Breeding and Genetics 132:218-228.</p>
<p>Tunnicliffe W. 1989. On the use of marginal likelihood in time series model estimation. JRSS 51(1):15-27.</p>
</div>
</div>



<!-- dynamically load mathjax for compatibility with self-contained -->
<script>
  (function () {
    var script = document.createElement("script");
    script.type = "text/javascript";
    script.src  = "https://mathjax.rstudio.com/latest/MathJax.js?config=TeX-AMS-MML_HTMLorMML";
    document.getElementsByTagName("head")[0].appendChild(script);
  })();
</script>

</body>
</html>
